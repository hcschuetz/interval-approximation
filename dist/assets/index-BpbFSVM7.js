(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=4,t=.5,n=2*Math.PI,r=document.querySelector(`#out`),i=r.getContext(`2d`),{width:a,height:o}=r,s=4,c=0,l=5,u=-.5,d=.5,f=0,p=0;function m(e){f=(a-2*s)/(e-c),p=s-f*c}var h=e=>f*e+p,g=o-2*l,_=l-g*u,v=(e,t)=>g/(2*t)*-e+_;function y(e,t,n,r,a){i.beginPath(),i.moveTo(h(e),v(t,a)),i.lineTo(h(n),v(r,a)),i.stroke()}var b=[];function x(t,r,a,o,s){i.beginPath();let c=h(t),l=v(r,a);b.push({X:c,Y:l,onin:o,onout:s}),i.arc(c,l,e,0,n),i.fill()}function S(t,r,a){i.beginPath(),i.arc(h(t),v(r,a),e*.6,0,n),i.fill()}var C=void 0;function w(e){let{left:t,top:n}=r.getBoundingClientRect(),{clientX:i,clientY:a}=e,o=i-t,s=a-n,c=b[0],l=Number.MAX_VALUE;for(let e of b){let t=(o-e.X)**2+(s-e.Y)**2;t<l&&(c=e,l=t)}l<5**2?c!==C&&(C?.onout(),C=c,c.onin(e)):(C?.onout(),C=void 0)}for(let e of[`pointerenter`,`pointermove`,`pointerdown`])r.addEventListener(e,w);r.addEventListener(`pointerleave`,()=>C?.onout());var T=document.querySelector(`#numerator`),E=document.querySelector(`#numerator-out`),D=document.querySelector(`#denominator`),O=document.querySelector(`#denominator-out`),k=document.querySelector(`#n-max`),A=document.querySelector(`#n-max-out`),j=document.querySelector(`#abs`),M=document.querySelector(`#abs-out`),N=document.querySelector(`#in-steps`),P=document.querySelector(`#in-steps-out`),F=document.querySelector(`label[for="max-cents"]`),I=document.querySelector(`#max-cents`),L=document.querySelector(`#max-cents-out`),R=document.querySelector(`#limits`),z=document.querySelector(`#optima`),B=document.querySelector(`#strands`),V=document.querySelector(`#strands-out`),H=document.querySelector(`#ratio`),U=document.querySelector(`#interval-in-octaves`),W=document.querySelector(`#interval-times-strands`);document.querySelector(`#duplicate-btn`).addEventListener(`click`,()=>window.open(location.href));function G(){i.strokeStyle=`#888`,i.fillStyle=`#000`,i.lineWidth=.5;let e=Number.parseInt(k.value);y(c,0,e,0,d),y(c,u,c,d,d),i.font=`10px sans`;for(let t=c+10;t<=e;t+=10)y(t,-.04,t,.04,1),i.fillText(t.toString(),h(t)-5,v(-.1,1));if(N.checked){for(let e of[u,0,d])i.fillText(e.toString(),h(0),v(e,d)+3);R.checked&&(y(c,d,e,d,d),j.checked||y(c,u,e,u,d))}else{let n=Number.parseInt(I.value);i.fillText(`0ct`,h(0),v(0,n)+3);let r=n<20?5:n<50?10:n<100?20:n<200?50:100;for(let e=r;e<=n;e+=r)i.fillText(`-${e.toFixed()}ct`,h(0),v(-e,n)+3),i.fillText(`+${e.toFixed()}ct`,h(0),v(+e,n)+3);if(R.checked){let r=0,i=0;for(let a=1;a<=e;a+=t){let e=.5/a*1200;r&&(y(r,+i,a,+e,n),j.checked||y(r,-i,a,-e,n)),[r,i]=[a,e]}}}}var K=document.querySelector(`#dot-info`);function q(){let e=Number.parseInt(T.value)/Number.parseInt(D.value),n=Number.parseInt(k.value),r=Math.log2(e),a=Number.parseInt(B.value),o=Math.max(1,a),s=N.checked,c=Number.parseInt(I.value),l=s?d:c;H.value=e.toString(),U.value=r.toString(),W.value=a?(r*o).toString():`-`,b.length=0,i.lineWidth=1;for(let e=0;e<o;e++){i.strokeStyle=i.fillStyle=a?`hsl(${e/o}turn 100% 50%)`:`#000`;let s=0,c=0;for(let u=e;u<=n+a;u+=o){if(u===0)continue;let e=r*u,o=Math.round(e),d=o-e;if(x(u,Y(X(d,u)),l,e=>{K.style.display=`block`,K.style.left=Math.min(e.clientX,window.innerWidth-400)+`px`,K.style.top=e.clientY+10+`px`,K.value=`${o}/${u} = ${(o/u).toFixed(5)} = logâ‚‚(${T.value}/${D.value}) ${d<0?`-`:`+`} ${(Math.abs(d)/u).toFixed(5)}
where
${(d/u).toFixed(5)} octaves = ${(d/u*1200).toFixed(2)} ct = ${d.toFixed(5)} steps`},()=>K.style.display=`none`),a){let e=Y(d);if(s>0)if(Math.abs(e-c)>.5){let r=Math.sign(e-c);e-=r;let[a,o]=[s,X(c,s)];for(let d=a+t;d<=u&&!(d>n);d+=t){let t=J(s,c,u,e,d);if(Math.abs(t)>.5){let n=-.5*r,d=s+(u-s)*(n-c)/(e-c),f=X(n,d),p=-f;y(a,o,d,f,l),i.save(),i.setLineDash([2,4]),y(d,f,d,p,l),i.restore(),c+=r,e+=r,t+=r,[a,o]=[d,p]}let n=X(t,d);y(a,o,d,n,l),[a,o]=[d,n]}}else{let[r,i]=[s,X(c,s)];for(let a=r+t;a<=u&&!(a>n);a+=t){let t=X(J(s,c,u,e,a),a);y(r,i,a,t,l),[r,i]=[a,t]}}[s,c]=[u,e]}}}if(z.checked){let e=Number.MAX_VALUE;i.fillStyle=`#fff`;for(let t=1;t<=n;t++){let n=r*t,i=Math.round(n),a=i-n,o=Math.abs((i-n)/t);o<e&&(S(t,Y(X(a,t)),l),e=o-1e-12)}}}var J=(e,t,n,r,i)=>t+(i-e)/(n-e)*(r-t),Y=e=>j.checked?Math.abs(e):e,X=(e,t)=>N.checked?e:e/t*1200;for(let e of[T,D,k,j,N,I,R,z,B])e.addEventListener(`input`,()=>location.hash=new URLSearchParams({num:T.value,denom:D.value,nMax:k.value,unsigned:j.checked?`true`:`false`,inSteps:N.checked?`true`:`false`,maxCents:I.value,limits:R.checked?`true`:`false`,optima:z.checked?`true`:`false`,strands:B.value}).toString());function Z(){let e=new URLSearchParams(location.hash.substring(1));E.value=T.value=e.get(`num`)??`5`,O.value=D.value=e.get(`denom`)??`3`,A.value=k.value=e.get(`nMax`)??`60`,m(Number.parseInt(k.value)),j.checked=e.get(`unsigned`)===`true`,M.value=j.checked?`unsigned`:`signed`;{let t=N.checked=e.get(`inSteps`)===`true`;P.value=t?`measure in steps`:`measure in cents`,I.disabled=t,F.style.opacity=L.style.opacity=t?`0.5`:`1`}{let t=I.value=e.get(`maxCents`)??`60`;L.value=`-${t}ct ... +${t}ct`}R.checked=e.get(`limits`)===`true`,z.checked=e.get(`optima`)===`true`;{let t=e.get(`strands`)??`0`;B.value=t,V.value=t===`0`?`-`:t}i.clearRect(0,0,a,o),G(),q()}window.addEventListener(`hashchange`,Z),Z();