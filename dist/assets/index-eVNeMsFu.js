(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=100,t=4,n=2*Math.PI,r=document.querySelector(`#out`),i=r.getContext(`2d`),{width:a,height:o}=r,s=15,c=0,l=e,u=5,d=-.5,f=.5,p=(a-2*s)/(l-c),m=s-p*c,h=e=>p*e+m,g=o-2*u,_=u-g*d,v=(e,t)=>g/(2*t)*-e+_;function y(e,t,n,r,a){i.beginPath(),i.moveTo(h(e),v(t,a)),i.lineTo(h(n),v(r,a)),i.stroke()}var b=[];function x(e,r,a,o,s){i.beginPath();let c=h(e),l=v(r,a);b.push({X:c,Y:l,onin:o,onout:s}),i.arc(c,l,t,0,n),i.fill()}function S(e,r,a){i.beginPath(),i.arc(h(e),v(r,a),t*.6,0,n),i.fill()}var C=void 0;function w(e){let{left:t,top:n}=r.getBoundingClientRect(),{clientX:i,clientY:a}=e,o=i-t,s=a-n,c=b[0],l=Number.MAX_VALUE;for(let e of b){let t=(o-e.X)**2+(s-e.Y)**2;t<l&&(c=e,l=t)}l<5**2?c!==C&&(C?.onout(),C=c,c.onin(e)):(C?.onout(),C=void 0)}for(let e of[`pointerenter`,`pointermove`,`pointerdown`])r.addEventListener(e,w);r.addEventListener(`pointerleave`,()=>C?.onout());var T=document.querySelector(`#numerator`),E=document.querySelector(`#numerator-out`),D=document.querySelector(`#denominator`),O=document.querySelector(`#denominator-out`),k=document.querySelector(`#abs`),A=document.querySelector(`#abs-out`),j=document.querySelector(`#in-steps`),M=document.querySelector(`#in-steps-out`),N=document.querySelector(`label[for="max-cents"]`),P=document.querySelector(`#max-cents`),F=document.querySelector(`#max-cents-out`),I=document.querySelector(`#limits`),L=document.querySelector(`#optima`),R=document.querySelector(`#strands`),z=document.querySelector(`#strands-out`),B=document.querySelector(`#ratio`),V=document.querySelector(`#interval-in-octaves`),H=document.querySelector(`#interval-times-strands`);document.querySelector(`#duplicate-btn`).addEventListener(`click`,()=>window.open(location.href));function U(){i.strokeStyle=`#888`,i.fillStyle=`#000`,i.lineWidth=.5,y(c,0,l,0,f),y(c,d,c,f,f),i.font=`10px sans`;for(let e=c+10;e<=l;e+=10)y(e,-.04,e,.04,1),i.fillText(e.toString(),h(e)-5,v(-.1,1));if(j.checked){for(let e of[d,0,f])i.fillText(e.toString(),h(0),v(e,f)+3);I.checked&&(y(c,f,l,f,f),k.checked||y(c,d,l,d,f))}else{let e=Number.parseInt(P.value);i.fillText(`0ct`,h(0),v(0,e)+3);let t=e<20?5:e<50?10:e<100?20:e<200?50:100;for(let n=t;n<=e;n+=t)i.fillText(`-${n.toFixed()}ct`,h(0),v(-n,e)+3),i.fillText(`+${n.toFixed()}ct`,h(0),v(+n,e)+3);if(I.checked){let t=0,n=0;for(let r=1;r<l;r+=.3){let i=.5/r*1200;t&&(y(t,+n,r,+i,e),k.checked||y(t,-n,r,-i,e)),[t,n]=[r,i]}}}}var W=document.querySelector(`#dot-info`);function G(){let t=Number.parseInt(T.value)/Number.parseInt(D.value),n=Math.log2(t),r=Number.parseInt(R.value),a=Math.max(1,r),o=k.checked,s=j.checked,c=Number.parseInt(P.value),l=s?f:c;B.value=t.toString(),V.value=n.toString(),H.value=r?(n*a).toString():`-`,b.length=0,i.lineWidth=1;for(let t=0;t<a;t++){i.strokeStyle=i.fillStyle=r?`hsl(${t/a}turn 100% 50%)`:`#000`;let c=0,u=0;for(let i=t;i<=e;i+=a){if(i===0)continue;let e=n*i,t=Math.round(e),a=t-e,d=o?Math.abs(a):a,f=s?d:d/i*1200;x(i,f,l,e=>{W.style.display=`block`,W.style.left=Math.min(e.clientX,window.innerWidth-400)+`px`,W.style.top=e.clientY+10+`px`,W.value=`${t}/${i} = ${(t/i).toFixed(5)} = logâ‚‚(${T.value}/${D.value}) ${a<0?`-`:`+`} ${(Math.abs(a)/i).toFixed(5)}
where
${(a/i).toFixed(5)} octaves = ${(a/i*1200).toFixed(2)} ct = ${a.toFixed(5)} steps`},()=>{W.style.display=`none`}),r&&(c>0&&y(c,u,i,f,l),[c,u]=[i,f])}}if(L.checked){let t=Number.MAX_VALUE;i.fillStyle=`#fff`;for(let r=1;r<=e;r++){let e=n*r,i=Math.round(e),a=i-e,c=Math.abs((i-e)/r);if(c<t){let e=o?Math.abs(a):a,n=s?e:e/r*1200;S(r,n,l),t=c-1e-12}}}}for(let e of[T,D,k,j,P,I,L,R])e.addEventListener(`input`,()=>location.hash=new URLSearchParams({num:T.value,denom:D.value,unsigned:k.checked?`true`:`false`,inSteps:j.checked?`true`:`false`,maxCents:P.value,limits:I.checked?`true`:`false`,optima:L.checked?`true`:`false`,strands:R.value}).toString());function K(){let e=new URLSearchParams(location.hash.substring(1));E.value=T.value=e.get(`num`)??`5`,O.value=D.value=e.get(`denom`)??`3`,k.checked=e.get(`unsigned`)===`true`,A.value=k.checked?`unsigned`:`signed`;{let t=j.checked=e.get(`inSteps`)===`true`;M.value=t?`measure in steps`:`measure in cents`,P.disabled=t,N.style.opacity=F.style.opacity=t?`0.5`:`1`}{let t=P.value=e.get(`maxCents`)??`60`;F.value=`-${t}ct ... +${t}ct`}I.checked=e.get(`limits`)===`true`,L.checked=e.get(`optima`)===`true`;{let t=e.get(`strands`)??`0`;R.value=t,z.value=t===`0`?`-`:t}i.clearRect(0,0,a,o),U(),G()}window.addEventListener(`hashchange`,K),K();