(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=4,t=.5,n=2*Math.PI,r=document.querySelector(`#out`),i=r.getContext(`2d`),{width:a,height:o}=r,s=4,c=0,l=5,u=-.5,d=.5,f=0,p=0;function m(e){f=(a-2*s)/(e-c),p=s-f*c}var h=e=>f*e+p,g=o-2*l,_=l-g*u,v=(e,t)=>g/(2*t)*-e+_;function y(e,t,n,r,a){i.beginPath(),i.moveTo(h(e),v(t,a)),i.lineTo(h(n),v(r,a)),i.stroke()}var b=[];function x(t,r,a,o,s){i.beginPath();let c=h(t),l=v(r,a);b.push({X:c,Y:l,onin:o,onout:s}),i.arc(c,l,e,0,n),i.fill()}function S(t,r,a){i.beginPath(),i.arc(h(t),v(r,a),e*.6,0,n),i.fill()}var C=void 0;function w(e){let{left:t,top:n}=r.getBoundingClientRect(),{clientX:i,clientY:a}=e,o=i-t,s=a-n,c=b[0],l=Number.MAX_VALUE;for(let e of b){let t=(o-e.X)**2+(s-e.Y)**2;t<l&&(c=e,l=t)}l<5**2?c!==C&&(C?.onout(),C=c,c.onin(e)):(C?.onout(),C=void 0)}for(let e of[`pointerenter`,`pointermove`,`pointerdown`])r.addEventListener(e,w);r.addEventListener(`pointerleave`,()=>C?.onout());var T=document.querySelector(`#numerator`),E=document.querySelector(`#numerator-out`),D=document.querySelector(`#denominator`),O=document.querySelector(`#denominator-out`),k=document.querySelector(`#n-max`),A=document.querySelector(`#n-max-out`),j=document.querySelector(`#in-steps`),M=document.querySelector(`#in-steps-out`),N=document.querySelector(`label[for="max-cents"]`),P=document.querySelector(`#max-cents`),F=document.querySelector(`#max-cents-out`),I=document.querySelector(`#limits`),L=document.querySelector(`#optima`),R=document.querySelector(`#strands`),z=document.querySelector(`#strands-out`),B=document.querySelector(`#ratio`),V=document.querySelector(`#interval-in-octaves`),H=document.querySelector(`#interval-times-strands`);document.querySelector(`#duplicate-btn`).addEventListener(`click`,()=>window.open(location.href));function U(){i.strokeStyle=`#888`,i.fillStyle=`#000`,i.lineWidth=.5;let e=Number.parseInt(k.value);y(c,0,e,0,d),y(c,u,c,d,d),i.font=`10px sans`;for(let t=c+10;t<=e;t+=10)y(t,-.04,t,.04,1),i.fillText(t.toString(),h(t)-5,v(-.1,1));if(j.checked){for(let e of[u,0,d])i.fillText(e.toString(),h(0),v(e,d)+3);I.checked&&(y(c,d,e,d,d),y(c,u,e,u,d))}else{let n=Number.parseInt(P.value);i.fillText(`0ct`,h(0),v(0,n)+3);let r=n<20?5:n<50?10:n<100?20:n<200?50:100;for(let e=r;e<=n;e+=r)i.fillText(`-${e.toFixed()}ct`,h(0),v(-e,n)+3),i.fillText(`+${e.toFixed()}ct`,h(0),v(+e,n)+3);if(I.checked){let r=0,i=0;for(let a=1;a<=e;a+=t){let e=.5/a*1200;r&&(y(r,+i,a,+e,n),y(r,-i,a,-e,n)),[r,i]=[a,e]}}}}var W=document.querySelector(`#dot-info`);function G(){let e=Number.parseInt(T.value)/Number.parseInt(D.value),n=Number.parseInt(k.value),r=Math.log2(e),a=Number.parseInt(R.value),o=Math.max(1,a),s=j.checked,c=Number.parseInt(P.value),l=s?d:c;B.value=e.toString(),V.value=r.toString(),H.value=a?(r*o).toString():`-`,b.length=0,i.lineWidth=1;for(let e=0;e<o;e++){i.strokeStyle=i.fillStyle=a?`hsl(${e/o}turn 100% 50%)`:`#000`;let s=0,c=0;for(let u=e;u<=n+a;u+=o){if(u===0)continue;let e=r*u,o=Math.round(e),d=o-e;if(x(u,q(d,u),l,e=>{W.style.display=`block`,W.style.left=Math.min(e.clientX,window.innerWidth-400)+`px`,W.style.top=e.clientY+10+`px`,W.value=`${o}/${u} = ${(o/u).toFixed(5)} = logâ‚‚(${T.value}/${D.value}) ${d<0?`-`:`+`} ${(Math.abs(d)/u).toFixed(5)}
where
${(d/u).toFixed(5)} octaves = ${(d/u*1200).toFixed(2)} ct = ${d.toFixed(5)} steps`},()=>W.style.display=`none`),a){if(s>0)if(Math.abs(d-c)>.5){let e=Math.sign(d-c);d-=e;let[r,a]=[s,q(c,s)];for(let o=r+t;o<=u&&!(o>n);o+=t){let t=K(s,c,u,d,o);if(Math.abs(t)>.5){let n=-.5*e,o=s+(u-s)*(n-c)/(d-c),f=q(n,o),p=-f;y(r,a,o,f,l),i.save(),i.setLineDash([2,4]),y(o,f,o,p,l),i.restore(),c+=e,d+=e,t+=e,[r,a]=[o,p]}let n=q(t,o);y(r,a,o,n,l),[r,a]=[o,n]}}else{let[e,r]=[s,q(c,s)];for(let i=e+t;i<=u&&!(i>n);i+=t){let t=q(K(s,c,u,d,i),i);y(e,r,i,t,l),[e,r]=[i,t]}}[s,c]=[u,d]}}}if(L.checked){let e=Number.MAX_VALUE;i.fillStyle=`#fff`;for(let t=1;t<=n;t++){let n=r*t,i=Math.round(n)-n,a=Math.abs(i/t);a<e&&(S(t,q(i,t),l),e=a-1e-12)}}}var K=(e,t,n,r,i)=>t+(i-e)/(n-e)*(r-t),q=(e,t)=>j.checked?e:e/t*1200;for(let e of[T,D,k,j,P,I,L,R])e.addEventListener(`input`,()=>location.hash=new URLSearchParams({num:T.value,denom:D.value,nMax:k.value,inSteps:j.checked?`true`:`false`,maxCents:P.value,limits:I.checked?`true`:`false`,optima:L.checked?`true`:`false`,strands:R.value}).toString());function J(){let e=new URLSearchParams(location.hash.substring(1));E.value=T.value=e.get(`num`)??`5`,O.value=D.value=e.get(`denom`)??`3`,A.value=k.value=e.get(`nMax`)??`60`,m(Number.parseInt(k.value));{let t=j.checked=e.get(`inSteps`)===`true`;M.value=t?`measure in steps`:`measure in cents`,P.disabled=t,N.style.opacity=F.style.opacity=t?`0.5`:`1`}{let t=P.value=e.get(`maxCents`)??`60`;F.value=`-${t}ct ... +${t}ct`}I.checked=e.get(`limits`)===`true`,L.checked=e.get(`optima`)===`true`;{let t=e.get(`strands`)??`0`;R.value=t,z.value=t===`0`?`-`:t}i.clearRect(0,0,a,o),U(),G()}window.addEventListener(`hashchange`,J),J();